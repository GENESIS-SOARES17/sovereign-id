<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SovereignID - Neura</title>
    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js" type="application/javascript"></script>
    <style>
        body { 
            font-family: sans-serif; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            min-height: 100vh; 
            background-color: #0f172a; 
            color: white; 
            margin: 0;
        }
        .card { 
            background: #1e293b; 
            padding: 30px; 
            border-radius: 15px; 
            text-align: center; 
            width: 350px; 
            border: 1px solid #334155;
        }
        button { 
            background-color: #4f46e5; 
            color: white; 
            border: none; 
            padding: 15px; 
            border-radius: 8px; 
            cursor: pointer; 
            width: 100%; 
            font-weight: bold;
            margin-top: 10px;
        }
        input { 
            width: 100%; 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 5px; 
            border: 1px solid #334155; 
            background: #0f172a; 
            color: white; 
            box-sizing: border-box;
        }
        #status { margin-top: 15px; font-size: 0.8rem; color: #94a3b8; }
    </style>
</head>
<body>

    <div class="card">
        <h2>ðŸ†” SovereignID</h2>
        <p>Neura Testnet</p>
        
        <button id="btnConectar">Conectar MetaMask</button>
        
        <div id="areaMint" style="display:none;">
            <input type="text" id="inputHash" placeholder="Hash 0x...">
            <button id="btnMint">Mintar Identidade</button>
        </div>

        <div id="status">Aguardando conexÃ£o...</div>
    </div>

    <script>
        let conta;
        let contrato;
        const enderecoContrato = "0x17D7338880AD6926D00C9f482A10049395C0C1b2";
        const abi = ["function mint(bytes32 _hash) external"];

        const btnConectar = document.getElementById('btnConectar');
        const areaMint = document.getElementById('areaMint');
        const status = document.getElementById('status');

        btnConectar.onclick = async () => {
            if (window.ethereum) {
                try {
                    const contas = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    conta = contas[0];
                    btnConectar.innerText = "Conectado: " + conta.substring(0,6) + "...";
                    areaMint.style.display = "block";
                    status.innerText = "Carteira conectada!";
                } catch (e) {
                    status.innerText = "Erro ao conectar.";
                }
            } else {
                alert("Instale a MetaMask!");
            }
        };

        document.getElementById('btnMint').onclick = async () => {
            const hash = document.getElementById('inputHash').value;
            if (hash.length !== 66) {
                alert("Hash invÃ¡lido!");
                return;
            }
            try {
                const provider = new ethers.providers.Web3Provider(window.ethereum);
                const signer = provider.getSigner();
                contrato = new ethers.Contract(enderecoContrato, abi, signer);
                
                status.innerText = "Confirmando na MetaMask...";
                const tx = await contrato.mint(hash);
                status.innerText = "Enviado! Aguarde...";
                await tx.wait();
                status.innerText = "ðŸŽ‰ Mintado com sucesso!";
            } catch (e) {
                status.innerText = "Erro na transaÃ§Ã£o.";
            }
        };
    </script>
</body>
</html>
